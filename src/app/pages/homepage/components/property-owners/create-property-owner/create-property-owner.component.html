<!-- src/app/pages/homepage/components/property-owners/create-property-owner/create-property-owner.component.html -->

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="card shadow-sm">
        <div class="card-header bg-property-owner text-white">
          <h3 class="mb-0">Create Property Owner</h3>
        </div>
        <div class="card-body">
          <form [formGroup]="propertyOwnerForm" (ngSubmit)="onSubmit()" novalidate aria-label="Create Property Owner Form">
            <!-- VAT Number -->
            <div class="mb-4">
              <label for="vatNumber" class="form-label">
                <i class="bi bi-123" aria-hidden="true"></i> VAT Number
              </label>
              <input
                id="vatNumber"
                type="text"
                class="form-control"
                formControlName="vatNumber"
                maxlength="9"
                placeholder="Enter 9-digit VAT Number"
                aria-describedby="vatNumberHelp"
                required
              />
              <!-- Validation Feedback -->
              <div *ngIf="propertyOwnerForm.get('vatNumber')?.touched" class="form-text">
                <span *ngIf="propertyOwnerForm.get('vatNumber')?.hasError('required')" class="text-danger">
                  VAT Number is required.
                </span>
                <span *ngIf="propertyOwnerForm.get('vatNumber')?.hasError('pattern')" class="text-danger">
                  VAT Number must be exactly 9 digits.
                </span>
              </div>
            </div>

            <!-- Name and Surname -->
            <div class="row mb-4">
              <div class="col-md-6">
                <label for="name" class="form-label">
                  <i class="bi bi-person-fill" aria-hidden="true"></i> First Name
                </label>
                <input
                  id="name"
                  type="text"
                  class="form-control"
                  formControlName="name"
                  placeholder="Enter First Name"
                  required
                  aria-label="First Name"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('name')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('name')?.hasError('required')" class="text-danger">
                    First Name is required.
                  </span>
                </div>
              </div>
              <div class="col-md-6">
                <label for="surname" class="form-label">
                  <i class="bi bi-person-fill" aria-hidden="true"></i> Surname
                </label>
                <input
                  id="surname"
                  type="text"
                  class="form-control"
                  formControlName="surname"
                  placeholder="Enter Surname"
                  required
                  aria-label="Surname"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('surname')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('surname')?.hasError('required')" class="text-danger">
                    Surname is required.
                  </span>
                </div>
              </div>
            </div>

            <!-- Address -->
            <div class="mb-4">
              <label for="address" class="form-label">
                <i class="bi bi-house-fill" aria-hidden="true"></i> Address
              </label>
              <input
                id="address"
                type="text"
                class="form-control"
                formControlName="address"
                placeholder="Enter Address"
                aria-label="Address"
              />
            </div>

            <!-- Phone Number and Email -->
            <div class="row mb-4">
              <div class="col-md-6">
                <label for="phoneNumber" class="form-label">
                  <i class="bi bi-telephone-fill" aria-hidden="true"></i> Phone Number
                </label>
                <input
                  id="phoneNumber"
                  type="text"
                  class="form-control"
                  formControlName="phoneNumber"
                  placeholder="e.g., 697XXXXXXX or 26XXXXXXX"
                  aria-label="Phone Number"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('phoneNumber')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('phoneNumber')?.hasError('pattern')" class="text-danger">
                    Phone Number must start with 2 or 6 and be exactly 10 digits.
                  </span>
                </div>
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">
                  <i class="bi bi-envelope-fill" aria-hidden="true"></i> Email
                </label>
                <input
                  id="email"
                  type="email"
                  class="form-control"
                  formControlName="email"
                  placeholder="Enter Email"
                  required
                  aria-label="Email"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('email')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('email')?.hasError('required')" class="text-danger">
                    Email is required.
                  </span>
                  <span *ngIf="propertyOwnerForm.get('email')?.hasError('pattern')" class="text-danger">
                    Please enter a valid email address.
                  </span>
                </div>
              </div>
            </div>

            <!-- Username and Password -->
            <div formGroupName="loginUser" class="row mb-4">
              <div class="col-md-6">
                <label for="username" class="form-label">
                  <i class="bi bi-person-circle" aria-hidden="true"></i> Username
                </label>
                <input
                  id="username"
                  type="text"
                  class="form-control"
                  formControlName="username"
                  placeholder="Enter Username"
                  required
                  aria-label="Username"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('loginUser.username')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('loginUser.username')?.hasError('required')" class="text-danger">
                    Username is required.
                  </span>
                  <span *ngIf="propertyOwnerForm.get('loginUser.username')?.hasError('minlength')" class="text-danger">
                    Username must be at least 5 characters long.
                  </span>
                </div>
              </div>
              <div class="col-md-6">
                <label for="password" class="form-label">
                  <i class="bi bi-lock-fill" aria-hidden="true"></i> Password
                </label>
                <input
                  id="password"
                  type="password"
                  class="form-control"
                  formControlName="password"
                  placeholder="Enter Password"
                  required
                  aria-label="Password"
                />
                <!-- Validation Feedback -->
                <div *ngIf="propertyOwnerForm.get('loginUser.password')?.touched" class="form-text">
                  <span *ngIf="propertyOwnerForm.get('loginUser.password')?.hasError('required')" class="text-danger">
                    Password is required.
                  </span>
                  <span *ngIf="propertyOwnerForm.get('loginUser.password')?.hasError('minlength')" class="text-danger">
                    Password must be at least 4 characters long.
                  </span>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-flex justify-content-end">
              <button
                type="submit"
                class="btn btn-property-owner me-3"
                [disabled]="propertyOwnerForm.invalid"
                aria-label="Create Property Owner"
              >
                <i class="bi bi-check-circle-fill me-2" aria-hidden="true"></i> Create
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                (click)="cancel()"
                aria-label="Cancel Creation"
              >
                <i class="bi bi-x-circle-fill me-2" aria-hidden="true"></i> Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Success Modal Template -->
    <ng-template #successModal let-modal>
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="success-modal-title">
          <i class="bi bi-check-circle-fill me-2" aria-hidden="true"></i> Success
        </h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        Property Owner created successfully.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-light" (click)="modal.close('Close click')">Close</button>
      </div>
    </ng-template>

    <!-- Error Modal Template -->
    <ng-template #errorModal let-modal>
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="error-modal-title">
          <i class="bi bi-exclamation-triangle-fill me-2" aria-hidden="true"></i> Error
        </h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>
      <div class="modal-body">
        <ul class="error-list">
          <li *ngFor="let msg of errorMessages">{{ msg }}</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-light" (click)="modal.close('Close click')">Close</button>
      </div>
    </ng-template>
</div>
